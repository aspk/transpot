{% extends "layout.html" %}
{% block body %}
<body>

    <h1>My First Google Map</h1>

    <div id="googleMap" style="width:100%;height:90vh;"></div>

    <script>
	function myMap() {
	    var mapProp= {
    		center:new google.maps.LatLng(40.779244,-73.969134),
    		zoom:11,
	    };
	    var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
	    var marker = new google.maps.Marker({position: (40.779244,-73.969134), map: map})
	    google.maps.event.addListener(map, 'click', function(event) {placeMarker(map, event.latLng, marker);});
	}

	function placeMarker(map, location, marker, infowindow) {
		$.getJSON($SCRIPT_ROOT + '/api', {"lat": location.lat(),"long": location.lng()}, 
			function(data) {
				for (x in data) {
					var pos = new google.maps.LatLng(data[x].latitude,data[x].longitude);
					var bus_marker = new google.maps.Marker({position: pos, map: map});
				}
				marker.setPosition(location);
			});
      	return false;
	};
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXKvgZDurJurDKeZcEw97Sut5ENMM-DLA&amp;callback=myMap"></script>
</body>
{% endblock%}

